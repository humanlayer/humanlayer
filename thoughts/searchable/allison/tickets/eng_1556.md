
[ENG-1556] auto-accept edits mode
Status: spec in progress
Assignee: allison@humanlayer.dev

Comments:
[2025-07-09 14:50:50] allison@humanlayer.dev:
Basically press shift+tab to enable "Auto accept edits" which automatically approves Edit and Write commands. Will probably want to manage it on the daemon side. but accept requests to enable or disable the feature from client. a couple more json rpc endpoints perhaps. Starting a research on this.

[2025-07-09 15:04:14] Dexter Horthy:
@allison i have research going for this too

[2025-07-09 15:05:30] Dexter Horthy:
oh whoops yes its pushed now

[2025-07-09 15:06:14] Dexter Horthy:
i need to review/refine a little bit

[2025-07-09 15:08:11] allison@humanlayer.dev:
## Research Complete: Auto-Accept Edits Mode

I've completed the research to validate the implementation approach for the auto-accept edits mode (shift+tab feature). Here's what I found:

### âœ… Validation Confirmed

**1. Yes, the daemon (hld) is the correct place for this logic**
- Specifically in the **approval manager** (`hld/approval/manager.go`)
- The approval manager is the central authority that already owns the approval lifecycle
- Implementation requires minimal changes - just intercept at the `CreateApproval` method

**2. The WUI visualizes the three tool types distinctly:**
- **Edit Tool**: Shows diffs with old â†’ new string changes using CustomDiffViewer
- **Write Tool**: Displays full file content in a bordered box
- **MultiEdit Tool**: Shows sequential diffs with cumulative effect
- All visualization logic is in `eventToDisplayObject.tsx`

### ðŸŽ¯ Implementation Approach

The feature design already exists in the thoughts directory! Here's the plan:

1. **Trigger**: User presses Shift+Tab in UI
2. **Action**: Sets session-level `auto_accept_edits: true` setting
3. **Behavior**: When Edit/Write/MultiEdit tools are called:
   - Daemon checks session settings
   - If auto-accept is enabled, skips pending state and immediately approves
   - Still publishes events for UI consistency
4. **Toggle**: Press Shift+Tab again to disable

### ðŸ”§ Key Implementation Points

- **Approval Manager**: Modify `CreateApproval` method to check session settings first
- **Session Settings**: Add `auto_accept_edits` field to Session struct
- **RPC Endpoint**: May need new endpoint for toggling the setting
- **UI Handler**: Add Shift+Tab keyboard handler in SessionDetail component

### ðŸ“ Architecture Notes

- Session-level toggle (not global) for safety
- Follows existing auto-approval hierarchy: Session Settings > Project Rules > User Settings > CLI Flags
- No special handling needed per tool type - all three (Edit/Write/MultiEdit) can be treated the same

The full research document has been attached with detailed code references and line numbers.


View in Linear: https://linear.app/humanlayer/issue/ENG-1556/auto-accept-edits-mode
